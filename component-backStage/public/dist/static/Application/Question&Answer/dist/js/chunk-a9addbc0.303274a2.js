(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a9addbc0"],{5200:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"finsh"},[a("div",{class:"finsh-container "+(t.tData.finsh.container.avatar.img.url?"have-avatar":""),style:"background: url("+t.tData.finsh.container.bgurl+")  0% 0% / 100% 100% no-repeat;"+t.tData.finsh.container.style},[t.tData.finsh.container.avatar.img.url?a("div",{staticClass:"finsh-avatar",style:""+t.tData.finsh.container.avatar.style},[a("div",{ref:"avatar-container",staticClass:"avatar-container",style:""+t.tData.finsh.container.avatar.img.containerStyle}),a("p",{staticClass:"avatar-name",style:""+t.tData.finsh.container.avatar.name.style},[t._v(t._s(t.userInfo.nickname||t.tData.finsh.container.avatar.name.text))])]):t._e(),a("div",{staticClass:"finsh-result",attrs:{id:"finshHead"}},[a("span",{staticStyle:{"padding-left":".5rem"},style:t.tData.finsh.container.result.txt.style},[t._v(t._s(t.tData.finsh.container.result.txt.text[0]||"答题总用时："))]),a("span",{staticClass:"finsh-time",style:t.tData.finsh.container.result.timeStyle},[t._v(t._s(t.timeCost)+"s")]),a("span",{staticClass:"finsh-score",style:t.tData.finsh.container.result.txt.style},[t._v(t._s(t.tData.finsh.container.result.txt.text[1]||"本次挑战获得"))]),a("div",{staticClass:"finsh-fraction",style:t.tData.finsh.container.result.score.containerStyle},[a("span",{style:"background: url("+t.tData.finsh.container.result.score.bgurl+")  0% 0% / 100% 100% no-repeat;"+t.tData.finsh.container.result.score.style},[t._v(t._s(t.score))])]),a("span",{staticClass:"finsh-score",style:t.tData.finsh.container.result.txt.style},[t._v(t._s(t.tData.finsh.container.result.txt.text[2]||"分"))])]),a("div",{staticClass:"finsh-brand",style:"background:url("+t.tData.finsh.container.brand.bgurl+")  0% 0% / 100% 100% no-repeat;"+t.tData.finsh.container.brand.style},[a("p",{style:""+t.tData.finsh.container.brand.textStyle},[t._v(t._s(t.tData.finsh.container.brand.text||"你的冷知识库等级为"))]),a("div",{staticClass:"finsh-grade",style:""+t.tData.finsh.container.brand.img.containerStyle},t._l(t.remark.titleMatching,function(e,s){return a("img",{key:s,style:""+t.tData.finsh.container.brand.img.style,attrs:{src:e}})}),0)]),a("div",{staticClass:"finsh-banner",style:t.tData.finsh.container.remark.img.containerStyle},[a("img",{style:t.tData.finsh.container.remark.img.style,attrs:{src:t.remark.matching}})]),t._l(t.remark.text.split("&"),function(e,s){return a("p",{key:s,staticClass:"finsh-explan",style:t.tData.finsh.container.remark.textStyle},[t._v(t._s(e))])}),a("p",{staticClass:"finsh-tip",style:t.tData.finsh.container.tip.style,attrs:{id:"finshTip"}},[t._v(t._s(t.tData.finsh.container.tip.text||"长按保存截图"))])],2),a("div",{staticClass:"finsh-btn",attrs:{id:"finshBtn"}},t._l(t.tData.finsh.btn,function(e,s){return a("button",{key:s,style:"background: url("+e.bgurl+")  0% 0% / 100% 100% no-repeat;"+e.style,on:{click:function(a){t.domain(e.event)}}},[t._v(t._s(e.text))])}),0),a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"spare-parts"},[a("div",{staticClass:"finsh-result finsh-screenshot",attrs:{id:"headshot"}},[a("clock",{attrs:{done:!1}}),a("div",{staticClass:"finsh-headshot"},[a("span",{staticClass:"finsh-score",style:t.tData.finsh.container.result.txt.style},[t._v(t._s(t.tData.finsh.container.result.txt.text[1]||"本次挑战获得"))]),a("div",{staticClass:"finsh-fraction",style:t.tData.finsh.container.result.score.containerStyle},[a("span",{style:"background: url("+t.tData.finsh.container.result.score.bgurl+")  0% 0% / 100% 100% no-repeat;"+t.tData.finsh.container.result.score.style},[t._v(t._s(t.score))])]),a("span",{staticClass:"finsh-score",style:t.tData.finsh.container.result.txt.style},[t._v(t._s(t.tData.finsh.container.result.txt.text[2]||"分"))])])],1),a("div",{staticClass:"finsh-footshot",attrs:{id:"footshot"}},[a("img",{style:t.tData.finsh.qrcode.img.style,attrs:{src:t.tData.finsh.qrcode.img.url}}),a("p",[t._v(t._s(t.tData.finsh.qrcode.txt.text||"这么冷的知识库还有谁？"))])])]),a("div",{attrs:{id:"screenshot"}})])},i=[],n=(a("34ef"),a("795b")),r=a.n(n),o=(a("a481"),a("f499")),c=a.n(o),h=(a("ac6a"),a("cadf"),a("551c"),a("f751"),a("097d"),a("951f")),l=a("9a94"),f=a("9bb6"),u=a("b5a3"),d={name:"finsh",components:{clock:f["a"]},data:function(){return{score:0,remark:{text:""},timeCost:0,userInfo:this.$store.state.userInfo,tData:this.$store.state.tData}},watch:{"$store.state.tData":function(t){this.tData=t,this.$store.commit("Timing",this.tData.behavior.clock.outSet)}},methods:{setPoint:function(t,e){var a=this,s=[];this.tData.finsh.btn.forEach(function(i,n){i.event===t&&(s=a.$util.setPoint(i.point.set)),!0===i.point.enforce&&(3===s.length?_uxt.push(["_trackEvent",s[0],s[1],s[2]]):_uxt.push(["_trackEvent","".concat(a.tData.title,"_").concat(channel,"_结束页"),"点击按钮",e]))})},again:function(){this.setPoint("again","再测一次"),this.$store.commit("Timing",this.tData.behavior.clock.outSet),this.$store.commit("scoring",0),this.$router.push("/behavior")},analysis:function(){this.setPoint("analysis","查看解析"),this.$router.push("/analysis")},more:function(){console.log(decodeURI(encodeURI(c()(this.tData))))},domain:function(t){switch(t){case"again":return this.again();case"analysis":return this.analysis();case"more":return this.more()}},createImg:function(t){var e=t.offsetWidth,a=t.offsetHeight,s=document.createElement("canvas"),i=2;s.width=e*i,s.height=a*i,s.getContext("2d").scale(i,i);var n={scale:i,canvas:s,logging:!1,width:e,height:a,useCORS:!0};h(t,n).then(function(t){var e=t.getContext("2d");e.mozImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1;var a=l["convertToPNG"](t,t.width,t.height);a.classList.add("end-img"),a.style.width=t.width/i+"px",a.style.height=t.height/i+"px",$i("#screenshot")[0].appendChild(a)})},screenShot:function(){var t=this,e=$i("#app")[0].cloneNode(!0),a=$i("#domContianer")[0],s=a.firstChild,i=$i("#headshot")[0],n=$i("#footshot")[0];s&&a.removeChild(s),a.appendChild(e),setTimeout(function(){t.checkHeight(e),t.createImg(a)},500);var r=$i("#finshHead")[1],o=$i("#finshTip")[1],c=$i("#finshBtn")[1];r.style.display="none",o.style.display="none",c.style.display="none",r.parentNode.insertBefore(i,r.nextSibling),o.parentNode.insertBefore(n,o.nextSibling)},calc:function(){var t=this,e="";if(1===this.tData.behavior.clock.order?this.timeCost=this.$store.state.Timing:this.timeCost=this.tData.behavior.clock.outSet-this.$store.state.Timing,this.$store.state.Timing==this.tData.behavior.clock.outSet){var a=JSON.parse(sessionStorage.getItem("parentingUser"));if(!a)return;this.$store.commit("Timing",a.Timing),this.score=a.score}else this.tData.finsh.container.formula?(e=c()(this.tData.finsh.container.formula.replace(/\$time/g,this.timeCost).replace(/\$score/g,this.$store.state.scoring)),this.score=this.$util.evil(e)):this.score=(.4*this.$store.state.Timing+8*this.$store.state.scoring).toFixed(0),sessionStorage.setItem("parentingUser",'{"Timing":'.concat(this.$store.state.Timing,', "score":').concat(this.score,"}"));if(this.tData.finsh.container.remark.data.forEach(function(e,a){t.score>=e.interval.min&&t.score<e.interval.max&&(t.remark=e)}),this.tData.finsh.container.avatar.img.url){var s=new Image;s.style.cssText="\n            max-width: 1rem;\n            max-height: 1rem;\n            margin-top: -.05rem;\n            border: .05rem solid #0ba29a;\n            border-radius: 50%;\n            ",s.src=this.getBase64ByUrl(this.tData.finsh.container.avatar.img.url).then(function(e){s.src=e,s.onload=function(){t.$refs["avatar-container"].appendChild(s),t.screenShot()}})}else this.screenShot()},getBase64ByUrl:function(t,e,a){var s=new XMLHttpRequest;return s.open("GET",t,!0),s.responseType="arraybuffer",new r.a(function(t,e){s.onload=function(e){if(200==s.status){var i=new Uint8Array(s.response),n=i.length,r=new Array(n);while(n--)r[n]=String.fromCharCode(i[n]);var o=r.join(""),c=window.btoa(o),h="data:"+(a||"image/png")+";base64,"+c;t(h)}},s.send()})},checkHeight:function(t){t.parentNode.style.height="initial",t.parentNode.style.overflow="initial",t.style.height="initial",t.style.overflow="initial",t.firstChild.style.height="initial",document.documentElement.clientHeight<t.offsetHeight?t.style.height="120vh":(t.style.height="100vh",t.firstChild.style.height="100vh")}},created:function(){this.calc(),this.tData.finsh.bg&&(this.$store.commit("setAppBg",this.tData.finsh.bg.url),this.$store.commit("setAppBgStyle",this.tData.finsh.bg.style)),document.title=this.tData.finsh.title||this.tData.title},mounted:function(){var t=this.tData.finsh.share;if(t&&(t.title=t.title.replace(/\$title/g,this.remark.animal).replace(/\$time/g,this.timeCost).replace(/\$score/g,this.$store.state.scoring),t.desc=t.desc.replace(/\$title/g,this.remark.animal).replace(/\$time/g,this.timeCost).replace(/\$score/g,this.$store.state.scoring)),u["default"].initWeixin(t),0!=this.tData.finsh.point.enforce){var e=this.$util.setPoint(this.tData.finsh.point.set);3===e.length?_uxt.push(["_trackEvent",e[0],e[1],e[2]]):_uxt.push(["_trackEvent","".concat(this.tData.title,"_").concat(channel,"_结束页"),"进入页面","访问结束页"])}}},m=d,g=(a("cd39"),a("2877")),v=Object(g["a"])(m,s,i,!1,null,"170a0a86",null);e["default"]=v.exports},7057:function(t,e,a){},cd39:function(t,e,a){"use strict";var s=a("7057"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-a9addbc0.303274a2.js.map